<?php

//Settings.php -> Objects Redirector

//If an object is selected
if(isset($menu_selected)){
	$object_name = $menu_selected; //Get object directory name
	$object_nameicon = Variable::object_nameicon($menu_selected);

//Variables
	$object_dir = USER_OBJECTS.$object_name; //Directory of object
	$object_icon = USER_OBJECTS.$object_name."/icon.png"; //Icon of object (32x32)
	$object_longname = Variable::ObjectName($object_dir); //Translatable name of object
//////
	

//Generating Header
	$tpl->assign("text",$object_longname); 
	$tpl->assign("image",$object_icon);
	$tpl->draw(CORE_VIEWS."text/h1_image");

	include(CORE_FORMS."settings/objects/objects.redirect");

//3th Menu Navbar generation
	include(CORE_VIEWS."menu/settings/objects/navtab.view");

//Auto redirection to needed tab


//If a tab is selected redirected to the correct form
	if($tab_selected){
		switch ($tab_selected) {
			//Help Tabs
			case "help":
			Draw::md2help($object_name);
			break;

			//Actions Tabs
			case "action":
			$dir_list = Functions::getdir(USER_OBJECTS.$object_name."/actions/");
			include(CORE_VIEWS."menu/settings/objects/menu_md.view");
			if($dir_list > 0){
				//@todo If only one action redirect
				if(!isset($action_selected)){ //Available actions

					include(CORE_VIEWS."datatable/dbtable_actions.view");
				}
				else{ //Selected Action
					include(CORE_FORMS."/settings/objects/action.form");
				}
			}
			else
			{
				echo t("No actions");
			}
			break;

			//Electronics Tabs
			case "gpios": //If action object have different gpios
			include(CORE_FORMS."/settings/objects/gpios.form");
			break;

			case "electronics": //If action object have same gpios
			include(CORE_FORMS."/settings/objects/electronics.form");
			break;

			//Codes Tabs
			case "codes":
			include(CORE_FORMS."/settings/objects/codes.form");
			break;

			case "groups":
			include(CORE_FORMS."/settings/objects/groups.form");
			break;

			//Unknown Tab
			//default:
			//echo "default";
			//break;
		}
	}

}




?>