<?php
//Settings.php -> Objects Redirector

//If an object is selected
if(isset($_["name"])){
	$object_name = $_["name"]; //Get object directory name
	add_language(USER_OBJECTS.$object_name);
	$tab = isset($_["tab"]) ? $_["tab"] : false; //Is a tab selected?

//Variables
	$object_dir = USER_OBJECTS.$object_name; //Directory of object
	$object_icon = USER_OBJECTS.$object_name."/icon.png"; //Icon of object (32x32)
	$object_longname = Variable::ObjectName($object_dir); //Translatable name of object
//////
	
	$tpl->draw(CORE_VIEWS."grids/container/bordered_open");
//Generating Header
	$tpl->assign("text",$object_longname); 
	$tpl->assign("image",$object_icon);
	$tpl->draw(CORE_VIEWS."text/h1_image");

//3th Menu Navbar generation
	include(CORE_VIEWS."menu/objects.view");

//If a tab is selected redirected to the correct form
	if($tab){
		switch ($tab) {
			//Help Tabs
			case "help":
			Draw::md2help($object_name);
			break;

			//Actions Tabs
			case "actions":
			$actions_list = Functions::getdir(USER_OBJECTS.$object_name."/actions/");
			
			if($actions_list > 0){
				//@todo If only one action redirect
				if(!isset($_["action"])){ //Available actions
					include(CORE_VIEWS."/menu/available_actions.view");
					include(CORE_VIEWS."datatable/dbtable_actions.view");
				}
				else{ //Selected Action
					include(CORE_FORMS."/settings/objects/actions.form");
				}
			}
			else
			{
				echo "No actions";
			}
			break;

			//Electronics Tabs
			case "gpios":
			include(CORE_FORMS."/settings/objects/gpios.form");
			break;

			//Codes Tabs
			//case "codes":
			//	include(CORE_FORMS."/settings/objects/codes.form");
			//break;

			//Unknown Tab
			//default:
			//break;
		}
	}
	$tpl->draw(CORE_VIEWS."grids/container/close");
}
else{
	echo "TODO: Objects Overview";
}



?>